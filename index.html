<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Cash Register</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root {
    --card-pad: 14px;
    --card-radius: 12px;
    --gap: 14px;
    --font-size: 18px;    /* unified size across the app */
    --btn-pad: 12px 14px;
  }
  * { box-sizing: border-box; }
  body {
    font-family: Arial, Helvetica, sans-serif;
    margin: 0 auto;
    max-width: 720px;
    padding: 20px;
    text-align: center;
    font-size: var(--font-size);
    line-height: 1.35;
  }

  /* Access Gate */
  #gate {
    position: fixed; inset: 0; background: #fff; z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    padding: 24px;
  }
  #gate .panel {
    width: 100%; max-width: 360px;
    border: 1px solid #ddd; border-radius: var(--card-radius);
    padding: 18px;
    text-align: center;
  }
  #gate input {
    width: 100%; padding: 12px 14px; font-size: var(--font-size);
    border: 1px solid #ccc; border-radius: 10px; margin-top: 8px;
    text-align: center;
  }
  #gate button {
    margin-top: 10px; width: 100%;
  }
  #gate .err { color: #c00; min-height: 1.3em; margin-top: 6px; }

  /* Grid + Card (shared) */
  .grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--gap);
    align-items: stretch;
  }
  @media (max-width: 640px) {
    .grid { grid-template-columns: 1fr; }
  }
  .card {
    border: 1px solid #ddd;
    border-radius: var(--card-radius);
    padding: var(--card-pad);
    text-align: left;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    min-height: 160px; /* consistent visual rhythm */
  }
  .card h3 {
    margin: 0 0 8px;
    font-weight: bold;
    text-align: center;
  }
  .kv { margin: 4px 0; }

  /* Buttons */
  button {
    padding: var(--btn-pad);
    font-size: var(--font-size);
    border-radius: 10px;
    border: 1px solid #ccc;
    background: #f7f7f7;
    cursor: pointer;
  }
  button:disabled { opacity: 0.6; cursor: not-allowed; }
  .btn-row {
    display: flex;
    gap: var(--gap);
    justify-content: center;
    flex-wrap: wrap;
  }
  .btn-full { width: 100%; }
  .selected { background: #000; color: #fff; border-color: #000; }

  /* Quantity rows in Items card */
  .item-row {
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    align-items: center;
    gap: 10px;
    padding: 6px 0;
    border-bottom: 1px dashed #e6e6e6;
  }
  .item-row:last-child { border-bottom: none; }
  .item-name { text-align: left; }
  .price { text-align: center; min-width: 50px; }
  .qty-controls {
    display: grid;
    grid-template-columns: auto 50px auto;
    align-items: center;
    justify-items: center;
    gap: 8px;
  }
  .qty-badge {
    display: inline-block;
    min-width: 44px;
    text-align: center;
    padding: 6px 8px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: #fff;
  }

  /* Totals / Comp Color */
  .highlight { color: #c00; font-weight: bold; }

  /* Admin loading */
  #admin-loading { display: none; font-style: italic; margin: 8px 0; }
  #admin-content { display: none; }

  /* Screen toggles */
  #admin-screen { display: none; }

  /* Section title */
  .section-title { margin: 8px 0 12px; font-weight: bold; }
</style>
</head>
<body>

<!-- ===== ACCESS GATE (code: 5253) ===== -->
<div id="gate" aria-modal="true" role="dialog">
  <div class="panel">
    <h3>Enter Access Code</h3>
    <input id="gateInput" type="password" inputmode="numeric" placeholder="Code" />
    <div class="err" id="gateErr"></div>
    <button onclick="unlock()">Enter</button>
  </div>
</div>

<!-- ===== MAIN (POS) ===== -->
<div id="main-screen">
  <div class="grid" style="margin-bottom: var(--gap)">
    <!-- Items -->
    <div class="card">
      <h3>Items</h3>
      <div class="item-row" aria-label="Burger">
        <div class="item-name">Burger</div>
        <div class="price">$7</div>
        <div class="qty-controls">
          <button onclick="changeQty('burger',1)" aria-label="Add Burger">+</button>
          <span id="burgerQty" class="qty-badge" aria-live="polite">0</span>
          <button onclick="changeQty('burger',-1)" aria-label="Remove Burger">-</button>
        </div>
      </div>
      <div class="item-row" aria-label="Hot Dog">
        <div class="item-name">Hot Dog</div>
        <div class="price">$5</div>
        <div class="qty-controls">
          <button onclick="changeQty('hotdog',1)" aria-label="Add Hot Dog">+</button>
          <span id="hotdogQty" class="qty-badge" aria-live="polite">0</span>
          <button onclick="changeQty('hotdog',-1)" aria-label="Remove Hot Dog">-</button>
        </div>
      </div>
    </div>

    <!-- Payment -->
    <div class="card">
      <h3>Payment</h3>
      <div class="btn-row" style="margin-top: 6px;">
        <button id="cashBtn" class="btn-full" onclick="selectPayment('cash')">Cash</button>
        <button id="cardBtn" class="btn-full" onclick="selectPayment('card')">Card</button>
      </div>
      <div class="kv" style="text-align:center;margin-top:8px">
        Total: $<span id="total">0</span>
      </div>
    </div>

    <!-- Actions -->
    <div class="card">
      <h3>Actions</h3>
      <div class="btn-row" style="margin-top: 6px;">
        <button id="submitBtn" class="btn-full" onclick="submitOrder(event)">Submit Order</button>
      </div>
      <div class="btn-row" style="margin-top: 8px;">
        <button class="btn-full" onclick="showAdmin()">Admin Panel</button>
        <button class="btn-full" onclick="toggleComp()">Comp Order</button>
      </div>
      <div class="kv" style="text-align:center;margin-top:8px">
        <span id="compHint" aria-live="polite"></span>
      </div>
    </div>

    <!-- Summary -->
    <div class="card">
      <h3>Summary</h3>
      <div class="kv" id="summaryLines" style="text-align:center;">
        0 Burgers, 0 Hot Dogs
      </div>
    </div>
  </div>
</div>

<!-- ===== ADMIN ===== -->
<div id="admin-screen">
  <div class="section-title">Admin Panel</div>

  <div id="admin-loading" aria-live="polite">Loading admin dataâ€¦</div>

  <div id="admin-content">
    <div class="card" style="text-align:center; margin-bottom: var(--gap);">
      <div class="kv">
        <label for="dateSelect"><strong>Date:</strong></label>
        <select id="dateSelect" onchange="loadStats()"></select>
      </div>
      <div id="totalBlock" class="kv" style="margin-top:8px;"></div>
    </div>

    <div class="grid">
      <div class="card">
        <h3>Hot Dogs</h3>
        <div class="kv" id="hdMoney"></div>
        <div class="kv" id="hdItems"></div>
      </div>
      <div class="card">
        <h3>Cash</h3>
        <div class="kv" id="cashMoney"></div>
        <div class="kv" id="cashItems"></div>
      </div>
      <div class="card">
        <h3>Burger</h3>
        <div class="kv" id="bgMoney"></div>
        <div class="kv" id="bgItems"></div>
      </div>
      <div class="card">
        <h3>Card</h3>
        <div class="kv" id="cardMoney"></div>
        <div class="kv" id="cardItems"></div>
      </div>
    </div>

    <div class="btn-row" style="margin-top: var(--gap);">
      <button class="btn-full" onclick="showMain()">Back to Home</button>
    </div>
  </div>
</div>

<script>
/* ==== CONFIG ==== */
const API_URL = "https://script.google.com/macros/s/AKfycbwb_KZrwBErcWTsvnERHS33q0xXggrP1ymF_uxkH0dHiyxoY_nwZv2H4RsHcJfQAcY3/exec";
const ACCESS_CODE = "5253";
const prices = { burger: 7, hotdog: 5 };

/* ==== ACCESS GATE ==== */
function unlock() {
  const val = (document.getElementById("gateInput").value || "").trim();
  const err = document.getElementById("gateErr");
  if (val === ACCESS_CODE) {
    sessionStorage.setItem("cashregister_auth", "ok");
    document.getElementById("gate").style.display = "none";
    // focus first button for speed
    document.getElementById("cashBtn").focus();
  } else {
    err.textContent = "Invalid code.";
  }
}
window.addEventListener("keydown", (e) => {
  if (document.getElementById("gate").style.display !== "none" && e.key === "Enter") {
    unlock();
  }
});
window.addEventListener("load", () => {
  if (sessionStorage.getItem("cashregister_auth") === "ok") {
    document.getElementById("gate").st
